.. Log files:

=========
Log Files
=========

The Disk Tool Console (DTC) application maintains a log of benchmarks as it runs over a floppy disk. If running the application on the command line (CLI), the user needs to specify a filename for the log to be saved as, otherwise it will print to stdout. By default, the graphical user interface (GUI) saves this file in the location specified during configuration. This section describes the information included in a log file and how it might be interpreted before discussing the merits of saving the log files as metadata or supporting documentation. 

-------------------
Log files in brief:
-------------------

Somewhat confusingly, the logs output by the CLI and GUI are somewhat different in how each displays data, though the data conveyed is ultimately similar. A log file, regardless of its origin, contains the following information per track (and side, if applicable):

* tfer: the average transfer rate (bytes/second)
* rpm: revolutions per minute of the disk in the drive
* base: the base data band used in the track. This is calculated in two ways: from what is expected given the encoding scheme (MFM/FM/GCR) and what is detected on the disk surface by DTC. Data unit recorded in *μ*, though represented as *u* in the log file.
* band: the additional data bands used for recording information. Like the base, this is calculated both by detection and by what is expected by the encoding scheme directed by the user. Data unit recorded in *μ*, though represented as *u* in the log file. Per the official manual,[1_] floppies encoded FM should expect 2 bands in addition to the base, and disks encoded either MFM or GCR should expect 3 bands in addition to the base. 
* encoding outcome: based on how encoding methods are specified by the user, the log will report whether DTC could successfully decode data, successfully decode data with warnings, or not successfully decode data. Warning codes are detailed on page 22 of the official KryoFlux manual (though warning codes are presented as lower-case letters in the manual, and upper-case letters in the log file).

This data is presented in three line chunks, prefaced by a three-digit code specifying the track and side that the following data pertain to. In the following image, 05.0 refers to track 5, side 1. These lines will repeat if the user has specified that DTC should retry tracks more than once.
  
.. image:: images/log-files-figure01.png  
*Figure 1: Example snippet from a log file.*

The GUI log includes two extra features not present in the CLI log:

* The first line of a GUI-derived log file contains the corresponding command DTC ran as if it had run from the CLI
* A series of timestamps recorded in hexadecimal notation before each chunk of data listing the track and side information in a more human readable format.

.. image:: images/log-files-figure02.png
*Figure 2: Example showing hexadecmial timestamps and track and side information.*

------------------------------------------
Inferences from base and band information:
------------------------------------------

Looking more closely at the log file snippet below, there are a few inferences one may draw from the information presented.

.. image:: images/log-files-figure03.png
*Figure 3: Example snippet from a log file.*

In this case, the user specified that DTC should treat the source floppy disk as one with MFM encoding. According to a discussion on the KryoFlux message board with two of the creators of the device,[2_] MFM-encoded high density (HD) floppy disks should expect a base of 1 μ with bands at 2, 3, and 4 μs. In the example, DTC detected the base band at 1.003 μs and the additional bands at 1.999, 3.009, and 3.982 μs. This is as expected, and the data in the sector was successfully decoded to MFM.

Worth noting is that both the GUI and CLI allow the user to specify multiple types of sector image specifications at once, as well as the KryoFlux stream format. In the event that the user specifies a second or third type of sector image, the log should reflect the above information for each attempt. Further, because the KryoFlux stream function is encoding and format agnostic, this type of information is only available if the user specifies a sector image type.

--------------------------
What to do with log files:
--------------------------

How to treat log files generated by DTC in the long term will likely vary from institution to institution. It is useful in documenting the chain of custody of the disk and its contents--in fact an important document, as deriving a disk image is likely the first step an institution will take to stabilize its contents. Because it documents exactly what the DTC application found in each sector, it is also useful for reporting both the quality of the media and the actions taken by the archivist. Like stream files (described below), preserving the DTC log could aid future archivists when revisiting particularly troublesome floppies.
  
.. [1] http://www.kryoflux.com/download/kryoflux_manual.pdf
.. [2] http://forum.kryoflux.com/viewtopic.php?f=3&t=1044
